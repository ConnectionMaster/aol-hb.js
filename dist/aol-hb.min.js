!function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),n(1);var r=n(2),s=i(r),o=n(5),a=i(o),u=window.aolhb={};u.init=function(e,t){var n=new s.default(e,t);n.sendBidRequests(),u.renderAd=function(e){var t=n.getBidResponseByAlias(e);if(t){var i=new a.default(t,document);i.render()}},u.refreshAd=function(e){n.refreshAd(e)}},t.default=u},function(e,t){"use strict";Array.prototype.find||(Array.prototype.find=function(e){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,n=Object(this),i=n.length>>>0,r=arguments[1],s=0;s<i;s++)if(t=n[s],e.call(r,t,s,n))return t}),Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=r(["","://","/pubapi/3.0/","/\n      ","/0/-1/ADTECH;cmd=bid;cors=yes;\n      v=2;alias=",";",""],["","://","/pubapi/3.0/","/\n      ","/0/-1/ADTECH;cmd=bid;cors=yes;\n      v=2;alias=",";",""]),u=n(3),d=n(4),l=i(d),c=n(5),f=i(c),p=function(){function e(t,n){s(this,e),this.bidRequestConfig=t,this.placementsConfigs=n,this.bidderKey=t.bidderKey||"aolbid",this.aliasKey=t.aliasKey||"mpalias",this.userSyncOn=t.userSyncOn||e.HEADER_BIDDING_EVENTS.bidResponse,this.bidResponses=[]}return o(e,[{key:"sendBidRequests",value:function(){var e=this;this.placementsConfigs.forEach(function(t){(0,u.sendGetRequest)(e.formatBidRequestUrl(t),function(n){e.handleBidRequestResponse(t,n),e.checkBidResponsesState()})})}},{key:"refreshAd",value:function(e){var t=this,n=this.getPlacementConfigByAlias(e);n&&(0,u.sendGetRequest)(this.formatBidRequestUrl(n),function(e){t.handleBidRequestResponse(n,e)})}},{key:"formatBidRequestUrl",value:function(e){var t=l.default.formatTemplateString(a,"protocol","hostName","network","placement","alias","bidFloorPrice"),n={protocol:l.default.resolveHttpProtocol(document.location.protocol),hostName:this.resolveHostName(),network:this.bidRequestConfig.network,placement:parseInt(e.placement),alias:e.alias,bidFloorPrice:this.resolveBidFloorPrice(e.bidFloorPrice)};return t(n)}},{key:"handleBidRequestResponse",value:function(e,t){var n=this.bidRequestConfig.onBidResponse,i=JSON.parse(t),r=this.createBidResponse(i,e);r&&(this.renderPixels(r),n&&n(r))}},{key:"checkBidResponsesState",value:function(){var e=this.placementsConfigs.length===this.bidResponses.length,t=this.bidRequestConfig.onAllBidResponses;e&&t&&t(this.bidResponses)}},{key:"resolveBidFloorPrice",value:function(e){return e?"bidfloor="+e.toString()+";":""}},{key:"resolveHostName",value:function(){return e.SERVER_MAP[this.bidRequestConfig.region]||e.SERVER_MAP.US}},{key:"getBidData",value:function(e){try{return e.seatbid[0].bid[0]}catch(e){return}}},{key:"getPixels",value:function(e){try{return e.ext.pixels}catch(e){return}}},{key:"getCPM",value:function(e){return e.ext&&e.ext.encp?e.ext.encp:e.price}},{key:"getBidResponseByAlias",value:function(e){return this.bidResponses.find(function(t){return t.alias===e})}},{key:"addNewBidResponse",value:function(e){if(e){var t=this.getBidResponseByAlias(e.alias);if(t){var n=this.bidResponses.indexOf(t);this.bidResponses[n]=e}else this.bidResponses.push(e)}}},{key:"createBidResponse",value:function(e,t){var n=this.formatBidResponse(e,t);if(n)return this.addNewBidResponse(n),n}},{key:"formatBidResponse",value:function(e,t){var n=this.getBidData(e);if(n)return{cpm:this.getCPM(n),ad:n.adm,pixels:this.getPixels(e),adContainerId:t.adContainerId,width:n.w,height:n.h,creativeId:n.crid,bidderCode:this.bidderKey,aliasKey:this.aliasKey,alias:t.alias}}},{key:"getPlacementConfigByAlias",value:function(e){return this.placementsConfigs.find(function(t){return t.alias===e})}},{key:"isUserSyncOnBidResponseMode",value:function(){return this.userSyncOn===e.HEADER_BIDDING_EVENTS.bidResponse}},{key:"renderPixels",value:function(e){if(e.pixels&&this.isUserSyncOnBidResponseMode()){var t=new f.default(e);t.renderPixels(),e.pixelsRendered=!0}}}]),e}();p.SERVER_MAP={EU:"adserver.adtech.de",US:"adserver.adtechus.com",Asia:"adserver.adtechjp.com"},p.HEADER_BIDDING_EVENTS={bidResponse:"bidResponse",adRender:"adRender"},t.default=p},function(e,t){"use strict";function n(e,t,n){var i=new XMLHttpRequest,r=function(){i.readyState===XMLHttpRequest.DONE&&n&&n(i.responseText)};i.withCredentials=!0,i.open(t,e),i.onreadystatechange=r,i.send()}function i(e,t){return n(e,"GET",t)}Object.defineProperty(t,"__esModule",{value:!0}),t.sendRequest=n,t.sendGetRequest=i},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={formatTemplateString:function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return function(){for(var t=arguments.length,r=Array(t),s=0;s<t;s++)r[s]=arguments[s];var o=r[r.length-1]||{},a=[e[0]];return i.forEach(function(t,n){var i=Number.isInteger(t)?r[t]:o[t];a.push(i,e[n+1])}),n.trimTemplateStringResult(a.join(""))}},trimTemplateStringResult:function(e){return e?e.replace(/(?:\n\s*)/g,""):null},resolveHttpProtocol:function(e){return"https:"===e?"https":"http"}};t.default=n},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(t){n(this,e),this.bidResponse=t,this.document=document}return i(e,[{key:"render",value:function(){var e=this.createAdFrame();e&&(this.renderPixels(),this.insertElementInAdContainer(e),this.populateIframeContent(e))}},{key:"createAdFrame",value:function(){var e=this.document.createElement("iframe");return e.id="aol-pub-frame-"+this.bidResponse.adContainerId,e.name=e.id,e.style.border="0px",e.scrolling="no",e.frameborder=0,e.width=this.bidResponse.width,e.height=this.bidResponse.height,e.allowtransparency=!0,e.setAttribute("allowFullScreen","true"),e.setAttribute("mozallowFullScreen","true"),e.setAttribute("webkitAllowFullScreen","true"),e}},{key:"insertElementInAdContainer",value:function(e){var t=this.document.getElementById(this.bidResponse.adContainerId);t&&t.appendChild(e)}},{key:"prepareAdForIframe",value:function(e){if(e)return"<head></head><body><style></style>"+e+"</body>"}},{key:"populateIframeContent",value:function(e){var t=this.prepareAdForIframe(this.bidResponse.ad);t&&(e.contentWindow.document.open(),e.contentWindow.document.write(t),e.contentWindow.document.close())}},{key:"renderPixels",value:function(){if(this.bidResponse&&this.bidResponse.pixels&&!this.bidResponse.pixelsRendered){var e=this.parsePixelsItems(this.bidResponse.pixels);this.renderPixelsItems(e)}}},{key:"parsePixelsItems",value:function(e){var t=/(img|iframe)[\s\S]*?src\s*=\s*("([^"]*)"|'([^"]*)')/gi,n=/\w*(?=\s)/,i=/src=(")(.+)"/,r=[];return e&&e.match(t).forEach(function(e){var t=e.match(n),s=e.match(i);t&&s&&r.push({tagName:t[0].toUpperCase(),src:s[2]})}),r}},{key:"renderPixelsItems",value:function(t){var n=this;t.forEach(function(t){switch(t.tagName){case e.PIXELS_ITEMS.img:n.renderPixelsImage(t);break;case e.PIXELS_ITEMS.iframe:n.renderPixelsIframe(t)}})}},{key:"renderPixelsImage",value:function(e){var t=new Image;t.src=e.src}},{key:"renderPixelsIframe",value:function(e){var t=this.document.createElement("iframe");t.width=1,t.height=1,t.style="display: none",t.src=e.src,this.document.body.appendChild(t)}}]),e}();r.PIXELS_ITEMS={iframe:"IFRAME",img:"IMG"},t.default=r}]);